#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Obtener la rama actual
current_branch=$(git symbolic-ref --short HEAD)

# Verificar si estamos haciendo push a master
if [ "$current_branch" = "master" ]; then
  echo "ğŸš€ Detectado push a master - incrementando versiÃ³n..."
  
  # Ejecutar el script de build con bump de versiÃ³n
  npm run build:with-version
  
  # AÃ±adir los archivos de versiÃ³n al commit
  git add version.json
  git add public/version.json
  git add src/shared/utils/build-info.generated.ts
  git add package.json
  
  # Hacer commit con el bump de versiÃ³n
  git commit -m "chore: bump version for master push" --no-verify
  
  echo "âœ… VersiÃ³n incrementada y commiteada automÃ¡ticamente"
else
  echo "â„¹ï¸  Push a rama $current_branch - no se incrementa versiÃ³n"
fi 